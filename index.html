<!DOCTYPE html>
<!-- saved from url=(0061)file:///C:/Users/mizak/OneDrive/Desktop/TutionAttendance.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Miza's Attendance Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f2f2f2; }
    header { background-color: #007bff; color: white; padding: 15px; text-align: center; }
    .container { max-width: 1000px; margin: 20px auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .form-group { margin-bottom: 15px; }
    .form-group label { display: block; font-weight: bold; }
    .form-group input, .form-group select { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
    button { padding: 8px 12px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; margin-right: 5px; }
    button.cancel { background-color: #6c757d; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: left; }
    th { background-color: #007bff; color: white; }
    .login-form { max-width: 400px; margin: 50px auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    .view-password { margin-top: 5px; font-size: 0.9em; cursor: pointer; color: #007bff; user-select: none; }
    .action-btns button { padding: 5px 8px; margin-right: 5px; font-size: 0.9em; }
  </style>
</head>
<body>
<header>
  <h1>Miza's Attendance Tracker</h1>
</header>

<div id="loginPage" class="login-form">
  <h2>Parent / Admin Login</h2>
  <div class="form-group">
    <label for="loginName">Username</label>
    <input type="text" id="loginName">
  </div>
  <div class="form-group">
    <label for="loginPassword">Password</label>
    <input type="password" id="loginPassword">
    <div class="view-password" onclick="togglePasswordVisibility(&#39;loginPassword&#39;, this)">Show Password</div>
  </div>
  <button onclick="loginUser()">Login</button>
</div>

<div id="adminPanel" class="container" style="display:none;">
  <h2>Admin Panel</h2>

  <h3 id="studentFormTitle">Add New Student</h3>
  <div class="form-group">
    <label for="newStudentName">Student Name</label>
    <input type="text" id="newStudentName">
  </div>
  <div class="form-group">
    <label for="newStudentPassword">Student Password</label>
    <input type="password" id="newStudentPassword">
    <div class="view-password" onclick="togglePasswordVisibility(&#39;newStudentPassword&#39;, this)">Show Password</div>
  </div>
  <div class="form-group">
    <label for="feePerHour">Fee per Hour (₹)</label>
    <input type="number" id="feePerHour" min="0">
  </div>
  <button id="addStudentBtn" onclick="addStudent()">Add Student</button>
  <button id="updateStudentBtn" style="display:none;" onclick="updateStudent()">Update Student</button>
  <button id="cancelStudentEditBtn" style="display:none;" class="cancel" onclick="cancelStudentEdit()">Cancel</button>

  <h3>Student List</h3>
  <table id="studentsTable">
    <thead>
      <tr><th>Name</th><th>Password</th><th>Fee per Hour (₹)</th><th>Actions</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <hr>
  <h3 id="attendanceFormTitle">Add Attendance Record</h3>
  <div class="form-group">
    <label for="studentSelect">Select Student</label>
    <select id="studentSelect"></select>
  </div>
  <div class="form-group">
    <label for="date">Date</label>
    <input type="date" id="date">
  </div>
  <div class="form-group">
    <label for="hours">Hours Taken</label>
    <input type="number" id="hours" min="0">
  </div>
  <div class="form-group">
    <label for="subject">Subject</label>
    <input type="text" id="subject">
  </div>
  <div class="form-group">
    <label for="portion">Portions Covered</label>
    <input type="text" id="portion">
  </div>
  <button id="addAttendanceBtn" onclick="addAttendanceRecord()">Add Attendance</button>
  <button id="updateAttendanceBtn" style="display:none;" onclick="updateAttendanceRecord()">Update Attendance</button>
  <button id="cancelAttendanceEditBtn" style="display:none;" class="cancel" onclick="cancelAttendanceEdit()">Cancel</button>

  <hr>
  <h3>All Attendance Records</h3>
  <table id="adminAttendanceTable">
    <thead>
      <tr><th>Student</th><th>Date</th><th>Hours</th><th>Subject</th><th>Portions</th><th>Fee (₹)</th><th>Actions</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>Total Fees per Student</h3>
  <table id="totalFeesTable">
    <thead>
      <tr><th>Student</th><th>Total Fee (₹)</th></tr>
    </thead>
    <tbody></tbody>
  </table>
  <button onclick="logout()">Logout</button>
</div>

<div id="studentPanel" class="container" style="display:none;">
  <h2>Attendance Records</h2>
  <table id="attendanceTable">
    <thead>
      <tr><th>Date</th><th>Hours</th><th>Subject</th><th>Portions</th><th>Fee (₹)</th></tr>
    </thead>
    <tbody></tbody>
  </table>
  <h3>Total Fees: ₹<span id="studentTotalFee">0</span></h3>
  <button onclick="logout()">Logout</button>
</div>

<script>
  const adminUsername = "Miza.k.das";
  const adminPassword = "15/09/2002";
  const STUDENTS_KEY = "attendance_students";
  const ATTENDANCE_KEY = "attendance_records";

  let studentPasswords = JSON.parse(localStorage.getItem(STUDENTS_KEY)) || {};
  let attendanceData = JSON.parse(localStorage.getItem(ATTENDANCE_KEY)) || [];

  // Track which student or attendance is being edited
  let editingStudent = null;
  let editingAttendanceIndex = null;

  function togglePasswordVisibility(inputId, toggleElem) {
    const input = document.getElementById(inputId);
    input.type = input.type === "password" ? "text" : "password";
    toggleElem.textContent = input.type === "text" ? "Hide Password" : "Show Password";
  }

  function loginUser() {
    const username = document.getElementById("loginName").value.trim();
    const password = document.getElementById("loginPassword").value.trim();
    if (username === adminUsername && password === adminPassword) {
      showAdminPanel();
    } else if (studentPasswords[username] && studentPasswords[username].password === password) {
      showStudentPanel(username);
    } else {
      alert("Invalid username or password!");
    }
  }

  function logout() {
    document.getElementById("loginPage").style.display = "block";
    document.getElementById("adminPanel").style.display = "none";
    document.getElementById("studentPanel").style.display = "none";
    document.getElementById("loginName").value = "";
    document.getElementById("loginPassword").value = "";
    editingStudent = null;
    editingAttendanceIndex = null;
  }

  function saveStudents() {
    localStorage.setItem(STUDENTS_KEY, JSON.stringify(studentPasswords));
  }

  function saveAttendance() {
    localStorage.setItem(ATTENDANCE_KEY, JSON.stringify(attendanceData));
  }

  // ------- STUDENT MANAGEMENT ---------

  function addStudent() {
    const name = document.getElementById("newStudentName").value.trim();
    const password = document.getElementById("newStudentPassword").value.trim();
    const feePerHour = parseFloat(document.getElementById("feePerHour").value);

    if (!name || !password || isNaN(feePerHour) || feePerHour <= 0) {
      alert("Please fill all fields correctly.");
      return;
    }
    if (studentPasswords[name]) {
      alert("Student already exists!");
      return;
    }

    studentPasswords[name] = {
      password: password,
      feePerHour: feePerHour
    };

    saveStudents();
    alert(`Student "${name}" added successfully!`);
    resetStudentForm();
    populateStudentDropdown();
    renderStudentsTable();
  }

  function renderStudentsTable() {
    const tbody = document.querySelector("#studentsTable tbody");
    tbody.innerHTML = "";
    for (const student in studentPasswords) {
      const info = studentPasswords[student];
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${student}</td>
        <td>${"*".repeat(info.password.length)}</td>
        <td>${info.feePerHour.toFixed(2)}</td>
        <td class="action-btns">
          <button onclick="editStudent('${student}')">Edit</button>
          <button onclick="deleteStudent('${student}')">Delete</button>
        </td>`;
      tbody.appendChild(tr);
    }
  }

  function editStudent(name) {
    editingStudent = name;
    const info = studentPasswords[name];
    document.getElementById("studentFormTitle").textContent = "Edit Student";
    document.getElementById("newStudentName").value = name;
    document.getElementById("newStudentName").disabled = true; // don't allow changing name (easy to implement)
    document.getElementById("newStudentPassword").value = info.password;
    document.getElementById("feePerHour").value = info.feePerHour;

    document.getElementById("addStudentBtn").style.display = "none";
    document.getElementById("updateStudentBtn").style.display = "inline-block";
    document.getElementById("cancelStudentEditBtn").style.display = "inline-block";
  }

  function updateStudent() {
    const password = document.getElementById("newStudentPassword").value.trim();
    const feePerHour = parseFloat(document.getElementById("feePerHour").value);

    if (!password || isNaN(feePerHour) || feePerHour <= 0) {
      alert("Please fill all fields correctly.");
      return;
    }

    studentPasswords[editingStudent] = {
      password: password,
      feePerHour: feePerHour
    };

    saveStudents();
    alert(`Student "${editingStudent}" updated successfully!`);
    resetStudentForm();
    populateStudentDropdown();
    renderStudentsTable();
    editingStudent = null;
  }

  function deleteStudent(name) {
    if (!confirm(`Are you sure you want to delete student "${name}"? This will also delete all their attendance records.`)) return;

    delete studentPasswords[name];
    attendanceData = attendanceData.filter(r => r.student !== name);
    saveStudents();
    saveAttendance();
    populateStudentDropdown();
    renderStudentsTable();
    renderAdminAttendanceTable();
    renderTotalFeesTable();
  }

  function cancelStudentEdit() {
    resetStudentForm();
    editingStudent = null;
  }

  function resetStudentForm() {
    document.getElementById("studentFormTitle").textContent = "Add New Student";
    document.getElementById("newStudentName").value = "";
    document.getElementById("newStudentName").disabled = false;
    document.getElementById("newStudentPassword").value = "";
    document.getElementById("feePerHour").value = "";
    document.getElementById("addStudentBtn").style.display = "inline-block";
    document.getElementById("updateStudentBtn").style.display = "none";
    document.getElementById("cancelStudentEditBtn").style.display = "none";
  }

  // ------- ATTENDANCE MANAGEMENT ---------

  function addAttendanceRecord() {
    const student = document.getElementById("studentSelect").value;
    const date = document.getElementById("date").value;
    const hours = parseFloat(document.getElementById("hours").value);
    const subject = document.getElementById("subject").value.trim();
    const portion = document.getElementById("portion").value.trim();

    if (!student || !date || isNaN(hours) || hours <= 0 || !subject || !portion) {
      alert("Please fill all fields correctly.");
      return;
    }

    if (!studentPasswords[student]) {
      alert("Selected student does not exist.");
      return;
    }

    const feePerHour = studentPasswords[student].feePerHour;
    const fee = feePerHour * hours;

    attendanceData.push({ student, date, hours, subject, portion, fee });
    saveAttendance();

    resetAttendanceForm();
    renderAdminAttendanceTable();
    renderTotalFeesTable();
  }

  function renderAdminAttendanceTable() {
    const tbody = document.querySelector("#adminAttendanceTable tbody");
    tbody.innerHTML = "";
    attendanceData.forEach((record, idx) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${record.student}</td>
        <td>${record.date}</td>
        <td>${record.hours}</td>
        <td>${record.subject}</td>
        <td>${record.portion}</td>
        <td>${record.fee.toFixed(2)}</td>
        <td class="action-btns">
          <button onclick="editAttendance(${idx})">Edit</button>
          <button onclick="deleteAttendance(${idx})">Delete</button>
        </td>`;
      tbody.appendChild(tr);
    });
  }

  function editAttendance(index) {
    editingAttendanceIndex = index;
    const record = attendanceData[index];

    document.getElementById("attendanceFormTitle").textContent = "Edit Attendance Record";
    document.getElementById("studentSelect").value = record.student;
    document.getElementById("date").value = record.date;
    document.getElementById("hours").value = record.hours;
    document.getElementById("subject").value = record.subject;
    document.getElementById("portion").value = record.portion;

    document.getElementById("addAttendanceBtn").style.display = "none";
    document.getElementById("updateAttendanceBtn").style.display = "inline-block";
    document.getElementById("cancelAttendanceEditBtn").style.display = "inline-block";
  }

  function updateAttendanceRecord() {
    const student = document.getElementById("studentSelect").value;
    const date = document.getElementById("date").value;
    const hours = parseFloat(document.getElementById("hours").value);
    const subject = document.getElementById("subject").value.trim();
    const portion = document.getElementById("portion").value.trim();

    if (editingAttendanceIndex === null) {
      alert("No attendance record is selected for editing.");
      return;
    }

    if (!student || !date || isNaN(hours) || hours <= 0 || !subject || !portion) {
      alert("Please fill all fields correctly.");
      return;
    }

    if (!studentPasswords[student]) {
      alert("Selected student does not exist.");
      return;
    }

    const feePerHour = studentPasswords[student].feePerHour;
    const fee = feePerHour * hours;

    attendanceData[editingAttendanceIndex] = { student, date, hours, subject, portion, fee };
    saveAttendance();

    resetAttendanceForm();
    renderAdminAttendanceTable();
    renderTotalFeesTable();
    editingAttendanceIndex = null;
  }

  function deleteAttendance(index) {
    if (!confirm("Are you sure you want to delete this attendance record?")) return;
    attendanceData.splice(index, 1);
    saveAttendance();
    renderAdminAttendanceTable();
    renderTotalFeesTable();
  }

  function cancelAttendanceEdit() {
    resetAttendanceForm();
    editingAttendanceIndex = null;
  }

  function resetAttendanceForm() {
    document.getElementById("attendanceFormTitle").textContent = "Add Attendance Record";
    document.getElementById("studentSelect").value = "";
    document.getElementById("date").value = "";
    document.getElementById("hours").value = "";
    document.getElementById("subject").value = "";
    document.getElementById("portion").value = "";
    document.getElementById("addAttendanceBtn").style.display = "inline-block";
    document.getElementById("updateAttendanceBtn").style.display = "none";
    document.getElementById("cancelAttendanceEditBtn").style.display = "none";
  }

  // ------- STUDENT VIEW ---------

  function populateStudentDropdown() {
    const select = document.getElementById("studentSelect");
    select.innerHTML = "<option value=''>-- Select Student --</option>";
    for (const student in studentPasswords) {
      const opt = document.createElement("option");
      opt.value = student;
      opt.textContent = student;
      select.appendChild(opt);
    }
  }

  function showAdminPanel() {
    document.getElementById("loginPage").style.display = "none";
    document.getElementById("adminPanel").style.display = "block";
    document.getElementById("studentPanel").style.display = "none";

    populateStudentDropdown();
    renderStudentsTable();
    renderAdminAttendanceTable();
    renderTotalFeesTable();
    resetStudentForm();
    resetAttendanceForm();
  }

  function showStudentPanel(username) {
    document.getElementById("loginPage").style.display = "none";
    document.getElementById("adminPanel").style.display = "none";
    document.getElementById("studentPanel").style.display = "block";

    renderStudentAttendance(username);
  }

  function renderStudentAttendance(username) {
    const tbody = document.querySelector("#attendanceTable tbody");
    tbody.innerHTML = "";
    let totalFee = 0;
    attendanceData.forEach(record => {
      if (record.student === username) {
        totalFee += record.fee;
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${record.date}</td>
          <td>${record.hours}</td>
          <td>${record.subject}</td>
          <td>${record.portion}</td>
          <td>${record.fee.toFixed(2)}</td>`;
        tbody.appendChild(tr);
      }
    });
    document.getElementById("studentTotalFee").textContent = totalFee.toFixed(2);
  }

  function renderTotalFeesTable() {
    const tbody = document.querySelector("#totalFeesTable tbody");
    tbody.innerHTML = "";
    for (const student in studentPasswords) {
      const totalFee = attendanceData
        .filter(r => r.student === student)
        .reduce((sum, r) => sum + r.fee, 0);
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${student}</td><td>${totalFee.toFixed(2)}</td>`;
      tbody.appendChild(tr);
    }
  }
</script>



</body></html>